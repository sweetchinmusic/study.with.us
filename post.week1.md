## 목표
자바 소스 파일(.java)을 JVM으로 실행하는 과정 이해하기.

## 학습할 것
* [JVM 이란 무엇인가](#JVM이란-무엇인가)
* 컴파일 하는 방법
* 실행하는 방법
* 바이트코드란 무엇인가
* JIT 컴파일러란 무엇이며 어떻게 동작하는지
* JVM 구성 요소
* JDK와 JRE의 차이

## JVM 이란 무엇인가


### 설명
Java Virtual Machine '자바 가상 머신'을 뜻하는 말로 바이트코드를 실행한다.

WORA ( Write Once Run Anywhere ), 한 번 작성하면 어디서든 실행할 수 있다는 의미로 

자바 코드로 작성한 프로그램은 실행할 환경 *운영체제 에 독립적으로 실행할 수 있다.

그리고 각 운영체제마다에 가상머신은 달리 한다.

이를 플랫폼의 독립적이라고 한다. 반면에 C 프로그램은 기계어에서 바로 컴파일 하므로 H/W에 맞게 컴파일 해야하고
이를 플랫폼에 종속적이라고 한다.

 ### 정리

간단히 말해 JVM은
Java 클래스 파일을 로드하고 바이트 코드를 해석하며, 메모리 등의 자원을 할당하고 관리하며 정보를 처리하는
작업을 하는 프로그램. OS는 JVM을 실행하고, JVM은 Java프로그램을 실행한다.

### 컴파일하는 방법
compile : .java파일을 .class 파일(바이트코드)로 만든다는 것을 의미.
JDK를 설치하면 bin 폴더에 javac라는 java compiler가 있다.
이 명령을 사용해 .class 파일로 만든다.

.java -> 컴파일러 -> .class -> ( 여기서 부터 JVM의 역할 ) -> 로딩 -> 배치 -> 실행

### 실행하는 방법

실행 시 java 명령어를 사용한다.
java.exe -> 자바 인터프리터로서 컴파일러로 생성된 바이트 코드를 해석하고 실행한다.

### JIT 컴파일러란 무엇인가

JIT는 Just-In-Time 뜻이며 JRE안에서 실제 실행하는 시점 ( Runtime )에서
해당 플래폼에 맞는 기계어 ( native machine code )로 컴파일하는 기법이다.
즉 JRE안에 존재하면서 프로그램을 실행할 때 기계어로 번역해 전달하는 장치.

### 왜 쓰이고 어떻게 동작하는가?

자바 바이트 코드는 인터프리터로서 한 줄씩 읽고 해석해, 그에 맞는 기능을 실행시키는 언어이기에
그 기기에서 직접 돌아가는 기계어로 컴파일 되는 C/C++와 같은 언어들로 만든 실행 파일에 비하면 속도가 느리다.

이 문제점을 개선하기 위해 같은 코드를 매번 새롭게 해석하는 대신, 실행하기 전에 미리 JIT 컴파일러로 사용해
반복적인 코드를 네이티브 코드로 전부 바꾸고 인터프리터가 컴파일된 네이티브 코드를 바로 사용해
인터프리터의 성능을 개선한다.

다만 컴파일하는 과정은 하나의 바이트코드를 인터프리팅하는 것보다 훨씬 오래 걸리므로
초기 실행 속도, 메모리 사용량에서 손해를 본다.
따라서, JIT 컴파일러를 사용하는 JVM들은 내부적으로 해당 메서드가 자주 수행되는지 체크하고
일정 체도를 넘을 때 컴파일한다.

### 바이너리 코드란 무엇인가

바이너리(binary) 코드는 컴퓨터가 인식할 수 있는 0과 1로 구성된 이진코드
### 바이트 코드란?

JVM이 읽을 수 있는 자바 소스 코드로 변환된 것을 의미한다. 컴파일러에 의해 변환된 코드 명령어 크기가 1바이트라서
그렇게 부른다.
즉 고급언어로 작성된 "소스코드"를 가상 머신이 이해할 수 있는 중간 코드로 컴파일 되어 어떤 플랫폼에도 종속되지 않게
실행될 수 있는 "가상 머신용 기계어 코드"이다.

"CPU"가 이해할 수 있는 언어가 "바이너리 코드"라면, "바이트 코드"는 "가상 머신"이 이해할 수 있는 바이너리 코드이다.


## JVM 구성 요소 - 네 가지 구성 요소를 가진다.

1. Class Loader
JRE의 일부로, 바이트코드를 실행할 때 class 객체를 메모리에 생성하는 요소이다.
클래스의 인스턴스를 생성하면 Class Loader를 통해 메모리에 로드한다.

2. GC ( Garbage Collector )
자바는 메모리 관리를 사용자가 아닌 JVM이 알아서 해준다.
GC는 더 이상 참조되지 않는 메모리를 정리해준다.
GC가 언제 호출되는지 알 수 없고, 호출해도 정리할 필요를 못 느끼면 안 한다.

3. Execution Engine
메모리에 로드된 바이트 코드 실행 역할.
Class Loader를 통해 Runtime Data Area에 배치된 바이트코드는 Exceution Engine에 의해 실행 된다.
인터프리터 방식이나 JIT방식으로 실행한다.

4. Runtime Data Area
JVM의 메모리 영역이다.
네 가지로 구분한다.
  + 클래스 영역 - 실행에 필요한 클래스를 로드하여 저장. 내부에서 메소드, 상수 영역으로 나눠 저장
  + 가비지 컬렉션 힙 영역 - GC가 관리하는 영역. 동적 메모리 할당 영역으로도 부르며, 소스상에 new 연산자로 객체를 만들 때 할당되는 영역.
  + 런타임 스택 영역 - 프로그램 실행 중 발생하는 메소드 호출과 복귀에 대한 정보를 저장한다.
  + 네이티브 메소드 스택 영역 - 자바에는 하드웨어를 직접 제어하는 기능이 없기 때문에, 필요한 경우 C언어와 같은 다른 언어의 기능을 빌려 사용한다.
이때 사용하는 기술이 JNI ( Java Native Interface ) 기술로 네이티브 메소드들이 바이트 코드로 변환 되면서 사용되고 기록하는 영역.


### JRE란
JRE + 소프 파일의 컴파일러 및 디버거 등을 자바 어플리케이션을 개발하기 위한 도구이며,
컴파일된 자바 프로그램을 실행(JRE의 목적)시킬 수 있는 자바 실행 환경으로
JVM + JVM이 자바 프로그램을 동작시킬 때 필요한 핵심 라이브러리 파일 + 자바 런타임 환경에서 사용하는 프로퍼티 세팅 
이나 리소스 파일을 가지고 있다.
### JDK란
JDK(Java Development kit)란 자바 애플리케이션 개발 환경으로 
JRE + 소스 파일의 컴파일러 및 디버거 등 자바 애플리케이션을 개발하기 위한 도구(javac, java등)가 포함되어 있다.

JRE는 *.class 파일을 JVM으로 로딩시키는 역할을 하고,
JVM은 *.class 파일을 해석해 실행할 수 있는 상태로 만든다.

즉 JDK를 설치하면 JRE도 같이 설치가 되기 때문에, JDK = JRE + @ 이다.
